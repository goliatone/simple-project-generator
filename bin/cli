#!/usr/bin/env node

'use strict';

const prog = require('caporal');
const pkg = require('../package.json');
const GenerateCommand = require('../commands/generate');

prog
    .version(pkg.version)
    .description(pkg.description)
    //$0 new ./example /tmp/core.io/output/#name#
    .command('new', 'Create a new project from a project template')
    .argument('[source]', 'Template name, local or repository', /.*/, GenerateCommand.DEFAULTS.source)
    .argument('[output]', 'Filename for output.', /.*/, GenerateCommand.DEFAULTS.output)
    .option('--clean', 'Should the contents of [source] be removed before running', prog.BOOL, GenerateCommand.DEFAULTS.options.clean)
    .option('--prompt-file', 'Prompt file for this project', prog.BOOL, GenerateCommand.DEFAULTS.options.saveGuiSchema)
    .option('--dry-run', 'Prompt file for this project', prog.BOOL, GenerateCommand.DEFAULTS.options.saveGuiSchema)
    .option('--templates <path>', '<path> to template files', null, GenerateCommand.DEFAULTS.options.templates)
    .action((args, options, logger) => {

        const command = new GenerateCommand({
            logger: logger
        });

        args.options = options;

        command.execute(args).catch(logger.error);
    });

prog.parse(process.argv);
